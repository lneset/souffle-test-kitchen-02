<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Soufflé Test Kitchen — Actionable Market Dashboard</title>
  <meta name="description" content="Score opportunities, run what‑if scenarios, and output a design brief—no backend required."/>
  <meta property="og:title" content="Soufflé Test Kitchen — Actionable Market Dashboard"/>
  <meta property="og:description" content="Score opportunities, run what‑if scenarios, and output a design brief—no backend required."/>
  <meta property="og:image" content="/social.png"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <link rel="icon" href="/favicon.png" type="image/png"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    :root{
      --bg1:#667eea;--bg2:#764ba2;--ink:#2d3748;--muted:#718096;
      --card:#ffffff;--glass:rgba(255,255,255,.95);--shadow:rgba(0,0,0,.1);
      --brand:#667eea;--accent:#ff6b6b;--mint:#4ecdc4;--sun:#ffd93d;--plum:#9b59b6;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--ink);line-height:1.55}
    .wrap{max-width:1400px;margin:0 auto;padding:20px;min-height:100vh}
    .card{background:var(--glass);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 20px 40px var(--shadow);padding:24px}
    .header{margin-bottom:24px}
    .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .logo{font-size:28px;font-weight:800;color:var(--brand)}
    .badge{background:linear-gradient(135deg,var(--accent),var(--sun));color:#fff;padding:8px 14px;border-radius:999px;font-weight:700;letter-spacing:.5px}
    h1{font-size:26px;margin:6px 0 4px}
    .sub{color:var(--muted)}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:24px}
    .panel{background:#fff;border-radius:16px;padding:18px;box-shadow:0 10px 20px rgba(0,0,0,.06)}
    .panel h3{font-size:16px;margin-bottom:12px}
    .weights .row{display:grid;grid-template-columns:1fr 60px;gap:10px;align-items:center;margin:8px 0}
    .weights input[type=range]{width:100%}
    .weights .val{font-variant-numeric:tabular-nums;text-align:right;color:var(--muted)}
    .scenario{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 2px}
    .scenario button{border:0;border-radius:999px;padding:8px 12px;background:#f3f4f6;cursor:pointer}
    .scenario button.active{background:#e0e7ff;color:#1f2937;font-weight:700;outline:2px solid #c7d2fe}
    .metrics{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:14px 0}
    .metric{background:#fff;border-left:4px solid var(--brand);border-radius:10px;padding:12px;text-align:center}
    .metric h2{font-size:22px}
    .metric p{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:1px}
    .charts{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:12px}
    .table{margin-top:16px}
    table{width:100%;border-collapse:separate;border-spacing:0 8px}
    th,td{padding:10px 12px;font-size:14px}
    th{color:var(--muted);text-align:left}
    tr{background:#fff}
    tr td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}
    tr td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}
    .chip{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px}
    .chip.win{background:#dcfce7;color:#166534}
    .chip.caution{background:#fef9c3;color:#854d0e}
    .chip.risk{background:#fee2e2;color:#991b1b}
    .brief{margin-top:18px;display:grid;grid-template-columns:1fr 300px;gap:16px}
    textarea{width:100%;height:220px;padding:12px;border-radius:10px;border:1px solid #e5e7eb;font-family:Inter,system-ui,sans-serif}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{border:0;background:var(--brand);color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn.alt{background:#111827}
    @media(max-width:1000px){
      .grid{grid-template-columns:1fr}
      .charts{grid-template-columns:1fr}
      .brief{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card header">
      <div class="top">
        <div class="logo">soufflé</div>
        <div class="badge">TEST KITCHEN</div>
      </div>
      <h1>Actionable Market Dashboard</h1>
      <p class="sub">Score white space, run what‑ifs, and auto‑generate an initial design brief.</p>
      <div class="metrics">
        <div class="metric"><h2 id="ms">$0</h2><p>Addressable Market</p></div>
        <div class="metric"><h2 id="segments">0</h2><p>Active Segments</p></div>
        <div class="metric"><h2 id="score">0</h2><p>Top Opportunity Score</p></div>
        <div class="metric"><h2 id="ttm">0 mo</h2><p>Fastest Time‑to‑Market</p></div>
      </div>
    </div>

    <div class="grid">
      <!-- Controls -->
      <div class="panel">
        <h3>Criteria & Weights (0–10)</h3>
        <div class="weights" id="weights"></div>
        <h3>What‑If Scenarios</h3>
        <div class="scenario" id="scenarios"></div>
        <div class="actions" style="margin-top:8px">
          <button class="btn" id="recalc">Recalculate</button>
          <button class="btn alt" id="reset">Reset</button>
        </div>
      </div>

      <!-- Charts + Matrix -->
      <div class="panel">
        <h3>Opportunity Scores</h3>
        <div class="charts">
          <canvas id="bar" height="280"></canvas>
          <canvas id="radar" height="280"></canvas>
        </div>
      </div>
    </div>

    <!-- Table -->
    <div class="card table" style="margin-top:16px">
      <h3 style="margin-bottom:8px">Prioritized Opportunities</h3>
      <table>
        <thead>
          <tr><th>Segment</th><th>Score</th><th>Design Play</th><th>Why Now</th><th>TTM</th></tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>

    <!-- Brief -->
    <div class="card brief">
      <div>
        <h3 style="margin-bottom:8px">Auto‑Generated Design Brief (Draft)</h3>
        <textarea id="brief"></textarea>
      </div>
      <div>
        <h3 style="margin-bottom:8px">Export</h3>
        <div class="actions">
          <button class="btn" id="copyBrief">Copy Brief</button>
          <button class="btn alt" id="downloadJSON">Download JSON</button>
        </div>
        <p class="sub" style="margin-top:8px">Use this as a starting point for a one‑pager. Refine copy before sharing.</p>
      </div>
    </div>
  </div>

<script>
// --- Static example data (editable later or wired to CSV) ---
const segments = [
  { key:'enterprise', name:'Enterprise Workplace', market:890, cagr:15, comp:6, complexity:6, readiness:7, regulation:3, brandfit:8, margin:7, ttm:6 },
  { key:'healthcare', name:'Healthcare Facilities', market:650, cagr:8, comp:7, complexity:7, readiness:6, regulation:8, brandfit:7, margin:6, ttm:9 },
  { key:'consumer', name:'Consumer Home', market:1200, cagr:22, comp:8, complexity:5, readiness:5, regulation:2, brandfit:8, margin:8, ttm:12 },
  { key:'hospitality', name:'Hospitality Venues', market:300, cagr:12, comp:6, complexity:5, readiness:6, regulation:4, brandfit:7, margin:6, ttm:7 },
  { key:'government', name:'Government Facilities', market:400, cagr:6, comp:7, complexity:8, readiness:4, regulation:9, brandfit:5, margin:5, ttm:10 }
];

// Criteria 0–10; higher is better unless 'complexity', 'regulation', 'comp' (competition) which invert.
const criteria = [
  { id:'market', label:'Market Size (relative)', invert:false },
  { id:'cagr', label:'Growth (CAGR)', invert:false },
  { id:'comp', label:'Competitive Intensity', invert:true },
  { id:'complexity', label:'Design Complexity', invert:true },
  { id:'readiness', label:'Manufacturing Readiness', invert:false },
  { id:'regulation', label:'Regulatory Risk', invert:true },
  { id:'brandfit', label:'Brand Fit', invert:false },
  { id:'margin', label:'Margin Potential', invert:false }
];

// Default weights by scenario
const scenarios = {
  'Balanced':       { market:7, cagr:6, comp:5, complexity:6, readiness:6, regulation:5, brandfit:6, margin:6 },
  'Speed-to-Market':{ market:6, cagr:5, comp:6, complexity:8, readiness:9, regulation:6, brandfit:6, margin:5 },
  'Premiumization': { market:6, cagr:6, comp:5, complexity:5, readiness:5, regulation:5, brandfit:9, margin:9 },
  'Cost-Down':      { market:6, cagr:6, comp:8, complexity:7, readiness:7, regulation:6, brandfit:5, margin:8 }
};

let activeScenario = 'Balanced';
let weights = {...scenarios[activeScenario]};

// --- UI builders ---
const weightsEl = document.getElementById('weights');
const scenariosEl = document.getElementById('scenarios');
const rowsEl = document.getElementById('rows');
const briefEl = document.getElementById('brief');
const msEl = document.getElementById('ms');
const segEl = document.getElementById('segments');
const scoreEl = document.getElementById('score');
const ttmEl = document.getElementById('ttm');

function numberFmt(n){return Intl.NumberFormat('en-US',{maximumFractionDigits:0}).format(n);}

// Sliders
function renderWeights(){
  weightsEl.innerHTML='';
  criteria.forEach(c=>{
    const row = document.createElement('div');
    row.className='row';
    row.innerHTML = \`
      <label for="w_\${c.id}">\${c.label}</label>
      <div class="val"><span id="wv_\${c.id}">\${weights[c.id]}</span></div>
    \`;
    const slider = document.createElement('input');
    slider.type='range'; slider.min=0; slider.max=10; slider.value=weights[c.id]; slider.id='w_'+c.id;
    slider.addEventListener('input', e=>{
      weights[c.id]=+e.target.value;
      document.getElementById('wv_'+c.id).textContent=weights[c.id];
    });
    row.insertBefore(slider,row.children[1]);
    weightsEl.appendChild(row);
  });
}

// Scenarios
function renderScenarios(){
  scenariosEl.innerHTML='';
  Object.keys(scenarios).forEach(name=>{
    const b=document.createElement('button'); b.textContent=name;
    if(name===activeScenario) b.classList.add('active');
    b.addEventListener('click',()=>{
      activeScenario = name;
      weights = {...scenarios[name]};
      renderWeights(); renderScenarios(); compute();
    });
    scenariosEl.appendChild(b);
  });
}

// Scoring
function normalize(value, min, max){ return max===min?0: (value - min) / (max - min) * 10; }
function scoreSegments(){
  const marketMin = Math.min(...segments.map(s=>s.market));
  const marketMax = Math.max(...segments.map(s=>s.market));
  return segments.map(s=>{
    // Normalize market to 0–10 relative
    const marketScore = normalize(s.market, marketMin, marketMax);
    const critVals = {
      market: marketScore,
      cagr: s.cagr,
      comp: s.comp,
      complexity: s.complexity,
      readiness: s.readiness,
      regulation: s.regulation,
      brandfit: s.brandfit,
      margin: s.margin
    };
    // Weighted sum: invert negatives
    let totalW=0, sum=0;
    for(const c of criteria){
      const w = weights[c.id]; totalW += w;
      const raw = critVals[c.id];
      const val = c.invert ? (10-raw) : raw;
      sum += val * w;
    }
    const score = totalW? Math.round((sum/totalW)*10)/10 : 0;
    const play = suggestPlay(s);
    const risk = riskChip(s);
    return {...s, score, play, risk};
  }).sort((a,b)=>b.score-a.score);
}

// Design playbook rules
function suggestPlay(s){
  if(s.complexity>=7 && s.readiness<=5) return 'Proof‑of‑Concept Sprint';
  if(s.brandfit>=8 && s.margin>=7 && s.complexity<=6) return 'Premium Accessory / Variant';
  if(s.comp>=8 && (10-s.regulation)>=6) return 'Differentiated Form Factor';
  if(s.readiness>=7 && s.complexity<=6) return 'Fast‑Track DFM Refresh';
  return 'Insight‑Led Concept Exploration';
}
function riskChip(s){
  const reg = s.regulation, comp = s.comp;
  if(reg>=8 || s.complexity>=8) return {class:'risk', label:'High Risk'};
  if(comp>=7) return {class:'caution', label:'Crowded'};
  return {class:'win', label:'Favorable'};
}

// Charts
let barChart, radarChart;
function renderCharts(sorted){
  const ctxB = document.getElementById('bar').getContext('2d');
  const ctxR = document.getElementById('radar').getContext('2d');
  const labels = sorted.map(s=>s.name);
  const data = sorted.map(s=>s.score);
  if(barChart) barChart.destroy();
  barChart = new Chart(ctxB, {
    type:'bar',
    data:{ labels, datasets:[{label:'Opportunity Score', data}]},
    options:{responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}}
  });
  // Radar: show weighted target vs average current
  const avg = id => sorted.reduce((acc,s)=>acc+s[id],0)/sorted.length;
  const current = criteria.map(c=>Math.round(avg(c.id)));
  const target = criteria.map(c=>Math.round((weights[c.id]/10)*10));
  if(radarChart) radarChart.destroy();
  radarChart = new Chart(ctxR, {
    type:'radar',
    data:{
      labels: criteria.map(c=>c.label),
      datasets:[
        {label:'Current (avg)', data: current, backgroundColor:'rgba(102,126,234,.18)', borderColor:'#667eea', borderWidth:2},
        {label:'Target (weights)', data: target, backgroundColor:'rgba(255,107,107,.18)', borderColor:'#ff6b6b', borderWidth:2}
      ]
    },
    options:{responsive:true, maintainAspectRatio:false, scales:{r:{beginAtZero:true,max:10,ticks:{stepSize:2}}}}
  });
}

// Table + metrics + brief
function renderTable(sorted){
  rowsEl.innerHTML='';
  sorted.forEach(s=>{
    const tr=document.createElement('tr');
    tr.innerHTML = \`
      <td>\${s.name} <span class="chip \${s.risk.class}">\${s.risk.label}</span></td>
      <td>\${s.score}</td>
      <td>\${s.play}</td>
      <td>\${whyNow(s)}</td>
      <td>\${s.ttm} mo</td>\`;
    rowsEl.appendChild(tr);
  });
  // Header metrics
  const totalMarket = sorted.reduce((a,s)=>a+s.market,0);
  msEl.textContent = '$'+numberFmt(totalMarket)+'M';
  segEl.textContent = sorted.length;
  scoreEl.textContent = sorted[0].score;
  ttmEl.textContent = sorted.reduce((min,s)=>Math.min(min,s.ttm),Infinity)+' mo';
}

function whyNow(s){
  const msgs=[];
  if(s.cagr>=15) msgs.push('High growth');
  if(s.readiness>=7) msgs.push('Supply‑chain ready');
  if(s.brandfit>=8) msgs.push('Strong brand fit');
  if(s.margin>=7) msgs.push('Healthy margin');
  if(s.regulation>=8) msgs.push('Regulated (partner early)');
  return msgs.slice(0,2).join(' • ') || 'Emerging opportunity';
}

function generateBrief(sorted){
  const top = sorted.slice(0,3);
  const lines = [];
  lines.push('Purpose: Identify near‑term product directions with strongest ROI potential.');
  lines.push('Scenario: '+activeScenario);
  lines.push('---');
  top.forEach((s,i)=>{
    lines.push((i+1)+'. '+s.name+' — Score '+s.score);
    lines.push('   Design Play: '+s.play);
    lines.push('   Why Now: '+whyNow(s));
    lines.push('   Time to Market: '+s.ttm+' months');
  });
  lines.push('---');
  lines.push('Next Steps:');
  lines.push('• 1‑week concept sprint focused on top segment');
  lines.push('• Stakeholder review + user probe (5–7 users)');
  lines.push('• DFM feasibility + unit economics check');
  briefEl.value = lines.join('\n');
}

function compute(){
  const sorted = scoreSegments();
  renderCharts(sorted);
  renderTable(sorted);
  generateBrief(sorted);
}

// Init
renderWeights();
renderScenarios();
compute();

// Buttons
document.getElementById('recalc').addEventListener('click', compute);
document.getElementById('reset').addEventListener('click', ()=>{ activeScenario='Balanced'; weights={...scenarios[activeScenario]}; renderWeights(); renderScenarios(); compute(); });
document.getElementById('copyBrief').addEventListener('click', ()=>{ briefEl.select(); document.execCommand('copy'); });
document.getElementById('downloadJSON').addEventListener('click', ()=>{
  const data = { generatedAt: new Date().toISOString(), scenario: activeScenario, weights, segments: scoreSegments() };
  const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='test-kitchen-output.json'; a.click();
  URL.revokeObjectURL(url);
});
</script>
</body>
</html>
